clear
write-host -Foregroundcolor Yellow "                                                                                                                ____                   "
write-host -Foregroundcolor Yellow "                                                                                                               /\___\                  "
write-host -Foregroundcolor Yellow "                                                                                                               \/___/                  "
write-host -Foregroundcolor Yellow " ______     ______     __   __     ______   __     ______     __  __     ______     ______     ______     __     ______     __   __    "
write-host -Foregroundcolor Yellow "/\  ___\   /\  __ \   /\  -.\ \   /\  ___\ /\ \   /\  ___\   /\ \/\ \   /\  == \   /\  __ \   /\  ___\   /\ \   /\  __ \   /\  -.\ \   "
write-host -Foregroundcolor Yellow "\ \ \____  \ \ \/\ \  \ \ \-.  \  \ \  __\ \ \ \  \ \ \__ \  \ \ \_\ \  \ \  __<   \ \  __ \  \ \ \____  \ \ \  \ \ \/\ \  \ \ \-.  \  "
write-host -ForegroundColor Yellow " \ \_____\  \ \_____\  \ \_\\ \_\  \ \_\    \ \_\  \ \_____\  \ \_____\  \ \_\ \_\  \ \_\ \_\  \ \_____\  \ \_\  \ \_____\  \ \_\\ \_\ "
write-host -ForegroundColor Yellow "  \/_____/   \/_____/   \/_/ \/_/   \/_/     \/_/   \/_____/   \/_____/   \/_/ /_/   \/_/\/_/   \/_____/   \/_/   \/_____/   \/_/ \/_/ "
write-host -ForegroundColor Yellow "                                                                                                                                       "
write-host -ForegroundColor Yellow " ______     ______     __   __     ______   ______     ______     __         ______     _____     ______     ______                    "
write-host -ForegroundColor Yellow "/\  ___\   /\  __ \   /\  -.\ \   /\__  _\ /\  == \   /\  __ \   /\ \       /\  __ \   /\  __-.  /\  __ \   /\  == \                   "
write-host -ForegroundColor Yellow "\ \ \____  \ \ \/\ \  \ \ \-.  \  \/_/\ \/ \ \  __<   \ \ \/\ \  \ \ \____  \ \  __ \  \ \ \/\ \ \ \ \/\ \  \ \  __<                   "
write-host -ForegroundColor Yellow " \ \_____\  \ \_____\  \ \_\\ \_\    \ \_\  \ \_\ \_\  \ \_____\  \ \_____\  \ \_\ \_\  \ \____-  \ \_____\  \ \_\ \_\                 "
write-host -ForegroundColor Yellow "  \/_____/   \/_____/   \/_/ \/_/     \/_/   \/_/ /_/   \/_____/   \/_____/   \/_/\/_/   \/____/   \/_____/   \/_/ /_/                 "
write-host -ForegroundColor Yellow "                                                                                                                                       "
write-host -ForegroundColor Yellow " _____     ______        _____     ______     __    __     __     __   __     __     ______                                            "
write-host -ForegroundColor Yellow "/\  __-.  /\  ___\      /\  __-.  /\  __ \   /\  -./  \   /\ \   /\  -.\ \   /\ \   /\  __ \                                           "
write-host -ForegroundColor Yellow "\ \ \/\ \ \ \  __\      \ \ \/\ \ \ \ \/\ \  \ \ \-./\ \  \ \ \  \ \ \-.  \  \ \ \  \ \ \/\ \                                          "
write-host -ForegroundColor Yellow " \ \____-  \ \_____\     \ \____-  \ \_____\  \ \_\ \ \_\  \ \_\  \ \_\\ \_\  \ \_\  \ \_____\                                         "
write-host -ForegroundColor Yellow "  \/____/   \/_____/      \/____/   \/_____/   \/_/  \/_/   \/_/   \/_/ \/_/   \/_/   \/_____/                                         "
write-host -ForegroundColor Yellow "                                                                                                                                       "
read-host "Pulsa una tecla para empezar...    "
clear
write-host ""
write-host "Cargando las características..."
write-host "0 %                                "
start-sleep -Seconds 0.7
clear
write-host ""
write-host "Cargando las características"
write-host -BackgroundColor Green "27 %       "
start-sleep -Seconds 0.7
clear
write-host ""
write-host "Cargando las características."
write-host -BackgroundColor Green "58 %                  "
start-sleep -Seconds 1
clear
write-host ""
write-host "Cargando las características."
write-host -BackgroundColor Red "70% - ERROR       X                "
start-sleep -Seconds 1
write-host ""
write-host ""
read-host "Pulsa una tecla para comprobar el estado de tu disco..."
tree C:/
Start-Sleep -Seconds 1
clear
write-host "Es broma, vamos al menú"
read-host "Pulsa una tecla para empezar... "
clear
write-host  "                                                                                                                ____                   "
write-host  "                                                                                                               /\___\                  "
write-host  "                                                                                                               \/___/                  "
write-host  " ______     ______     __   __     ______   __     ______     __  __     ______     ______     ______     __     ______     __   __    "
write-host  "/\  ___\   /\  __ \   /\  -.\ \   /\  ___\ /\ \   /\  ___\   /\ \/\ \   /\  == \   /\  __ \   /\  ___\   /\ \   /\  __ \   /\  -.\ \   "
write-host  "\ \ \____  \ \ \/\ \  \ \ \-.  \  \ \  __\ \ \ \  \ \ \__ \  \ \ \_\ \  \ \  __<   \ \  __ \  \ \ \____  \ \ \  \ \ \/\ \  \ \ \-.  \  "
write-host  " \ \_____\  \ \_____\  \ \_\\ \_\  \ \_\    \ \_\  \ \_____\  \ \_____\  \ \_\ \_\  \ \_\ \_\  \ \_____\  \ \_\  \ \_____\  \ \_\\ \_\ "
write-host  "  \/_____/   \/_____/   \/_/ \/_/   \/_/     \/_/   \/_____/   \/_____/   \/_/ /_/   \/_/\/_/   \/_____/   \/_/   \/_____/   \/_/ \/_/ "
start-sleep -Seconds 0.7
write-host  "                                                                                                                                       "
write-host  " ______     ______     __   __     ______   ______     ______     __         ______     _____     ______     ______                    "
write-host  "/\  ___\   /\  __ \   /\  -.\ \   /\__  _\ /\  == \   /\  __ \   /\ \       /\  __ \   /\  __-.  /\  __ \   /\  == \                   "
write-host  "\ \ \____  \ \ \/\ \  \ \ \-.  \  \/_/\ \/ \ \  __<   \ \ \/\ \  \ \ \____  \ \  __ \  \ \ \/\ \ \ \ \/\ \  \ \  __<                   "
write-host  " \ \_____\  \ \_____\  \ \_\\ \_\    \ \_\  \ \_\ \_\  \ \_____\  \ \_____\  \ \_\ \_\  \ \____-  \ \_____\  \ \_\ \_\                 "
write-host  "  \/_____/   \/_____/   \/_/ \/_/     \/_/   \/_/ /_/   \/_____/   \/_____/   \/_/\/_/   \/____/   \/_____/   \/_/ /_/                 "
write-host  "                                                                                                                                       "
start-sleep -Seconds 0.7
write-host  " _____     ______        _____     ______     __    __     __     __   __     __     ______                                            "
write-host  "/\  __-.  /\  ___\      /\  __-.  /\  __ \   /\  -./  \   /\ \   /\  -.\ \   /\ \   /\  __ \                                           "
write-host  "\ \ \/\ \ \ \  __\      \ \ \/\ \ \ \ \/\ \  \ \ \-./\ \  \ \ \  \ \ \-.  \  \ \ \  \ \ \/\ \                                          "
write-host  " \ \____-  \ \_____\     \ \____-  \ \_____\  \ \_\ \ \_\  \ \_\  \ \_\\ \_\  \ \_\  \ \_____\                                         "
write-host  "  \/____/   \/_____/      \/____/   \/_____/   \/_/  \/_/   \/_/   \/_/ \/_/   \/_/   \/_____/                                         "
write-host  "                                                                                                                                       "
write-host ""
write-host ""
write-host ""
start-sleep -Seconds 0.7
write-host -ForegroundColor Yellow "1. ACTIVE DIRECTORY Y DNS"
Write-Host -ForegroundColor Yellow "2. PROMOVER A CONTROLADOR DE DOMINIO"
Write-Host -ForegroundColor Yellow "3. INSTALAR Y CONFIGURAR DNS"
Write-Host -ForegroundColor Yellow "3. INSTALAR Y CONFIGURAR DHCP"
write-host -ForegroundColor Yellow "X. SALIR"
write-host " "
write-host " "
read-host "Pulsa un botón para comenzar... "
clear
write-host -ForegroundColor Yellow "1. ACTIVE DIRECTORY Y DNS"
write-host ""
write-host ""
write-host -ForegroundColor Yellow "INSTALACIÓN DE LOS SERVICIOS DE ACTIVE DIRECTORY"
write-host ""
read-host "Pulsa una tecla para continuar..."
    Install-windowsfeature -name AD-Domain-Services -IncludeAllSubFeature -IncludeManagementTools
    Install-windowsfeature -name DNS -IncludeManagementTools
    echo " " 
    write-host -foregroundcolor Green -nonewline "Instalado correctamente..."
    read-host " Pulsa una tecla para continuar..."
    clear
write-host -ForegroundColor Yellow "PROMOVER A CONTROLADOR DE DOMINIO"
write-host ""
read-host "Pulsa una tecla para continuar..."
$contra = read-host "Introduce la contraseña de administrador... "
    Import-module addsdeployment
    Install-ADDSForest -DomainName "Midominio.local" -DomainNetBiosName "Midominio" -SafeModeAdministratorPassword (ConvertTo-SecureString -string $contra -AsPlainText -Force) -DomainMode WinThreshold -ForestMode WinThreshold -InstallDNS:$True -Confirm:$false
    echo " " 
    write-host -foregroundcolor Green -nonewline "Se ha promovido a controlador de dominio correctamente..."
    read-host " Pulsa una tecla para continuar..."
    clear
write-host -ForegroundColor Yellow "INSTALACIÓN DE DNS"
write-host ""
write-host -ForegroundColor Yellow "LIMPIAR LA CACHÉ DNS"
read-host "Pulsa una tecla para continuar..."
clear
    ipconfig /flushdns
        write-host -BackgroundColor Green " 33 %    "
    Clear-DnsClientCache
        clear
        write-host -BackgroundColor Green " 66 %                "
    Remove-DnsServerZone -name midominio.local -force > $Null
        clear
        write-host -BackgroundColor Green " 100 % - Completado                 "
write-host ""
read-host "Pulsa una tecla para continuar"